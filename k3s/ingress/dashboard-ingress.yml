apiVersion: traefik.containo.us/v1alpha1
kind: Middleware
metadata:
  name: redirect-to-https
  namespace: default
spec:
  redirectScheme:
    scheme: https
    permanent: true
---
apiVersion: cert-manager.io/v1
kind: Issuer
metadata:
  name: letsencrypt-prod
  namespace: default # Ensure you configure this namespace properly
spec:
  acme:
    server: https://acme-v02.api.letsencrypt.org/directory
    email: hierzi.p@gmail.com # Replace with your email for Let's Encrypt notifications
    privateKeySecretRef:
      name: letsencrypt-prod
    solvers:
    - http01:
        ingress:
          class: traefik
---
kind: Certificate
apiVersion: cert-manager.io/v1
metadata:
  name: petclinic-cert
  namespace: default
spec:
  secretName: petclinic-secret-tls
  issuerRef:
    name: letsencrypt-prod
    kind: Issuer
  commonName: petclinic.ph-rustingheart.dns-dynamic.net # Your domain
  dnsNames:
    - petclinic.ph-rustingheart.dns-dynamic.net
    - www.petclinic.ph-rustingheart.dns-dynamic.net
